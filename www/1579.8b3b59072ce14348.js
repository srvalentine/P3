"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1579],{1579:(C,g,a)=>{a.r(g),a.d(g,{AsistenciaPageModule:()=>y});var u=a(6814),f=a(95),c=a(3582),r=a(467),d=a(5861),t=a(6689),m=a(6466),x=a(2014),p=a(2396),Z=a(8662);function U(i,h){if(1&i&&t._UZ(0,"img",9),2&i){const e=t.oxw();t.Q6J("src",e.selfieImageSrc,t.LSH)}}function A(i,h){if(1&i&&(t.TgZ(0,"div",10)(1,"ion-text",11),t._uU(2),t.qZA(),t.TgZ(3,"div")(4,"ion-text",12),t._uU(5),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"ion-text",12),t._uU(8,"------------------------"),t.qZA()()()),2&i){const e=t.oxw();t.xp6(2),t.AsE("Hola, ",e.loggedInUser.name," ",e.loggedInUser.lname,""),t.xp6(3),t.hij("Rut: ",e.loggedInUser.rut,"")}}function T(i,h){if(1&i&&(t.TgZ(0,"div",10)(1,"ion-text",11),t._uU(2),t.qZA(),t._UZ(3,"br"),t.TgZ(4,"ion-text",11),t._uU(5),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"ion-text",11),t._uU(8),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"ion-text",11),t._uU(11),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"ion-text",12),t._uU(14,"------------------------"),t.qZA(),t._UZ(15,"br"),t.TgZ(16,"ion-text",13),t._uU(17,"Coordenadas:"),t.qZA(),t._UZ(18,"br"),t.TgZ(19,"ion-text",13),t._uU(20),t.qZA(),t._UZ(21,"br"),t.TgZ(22,"ion-text",13),t._uU(23),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.hij("Profesor: ",e.qrData.profesor,""),t.xp6(3),t.hij("Hora de Clase: ",e.qrData.horaclase,""),t.xp6(3),t.hij("Sala: ",e.qrData.sala,""),t.xp6(3),t.hij("Dia: ",e.qrData.dia,""),t.xp6(9),t.hij("Latitud: ",e.latitud,""),t.xp6(3),t.hij("Longitud: ",e.longitud," ")}}const P=[{path:"",component:(()=>{class i{constructor(e,n,o,s,v,l){this.authService=e,this.router=n,this.route=o,this.storage=s,this.locationService=v,this.geolocation=l,this.loggedInUser=null,this.regionName="",this.comunaName="",this.latitud=0,this.longitud=0,this.selfieImageSrc=null}iraInicio(){this.authService.logout(),this.router.navigate(["/home"])}ngOnInit(){var e=this;return(0,d.Z)(function*(){yield e.storage.create();const n=yield e.storage.get("usuarioLogg");n&&(e.loggedInUser=n),e.route.queryParams.subscribe(o=>{o&&o.qrData&&(e.qrData=JSON.parse(o.qrData))})})()}obtenerUbicacion(){this.geolocation.getCurrentPosition().then(e=>{this.latitud=e.coords.latitude,this.longitud=e.coords.longitude}).catch(e=>{console.error("Error obteniendo la ubicaci\xf3n",e)})}ionViewDidEnter(){this.tomarSelfie(),this.obtenerUbicacion()}tomarSelfie(){var e=this;return(0,d.Z)(function*(){try{const n=yield navigator.mediaDevices.getUserMedia({video:!0}),o=document.createElement("video");o.srcObject=n,o.setAttribute("playsinline","true"),o.play(),o.addEventListener("loadeddata",()=>{const s=document.createElement("canvas");s.width=o.videoWidth,s.height=o.videoHeight,s.getContext("2d").drawImage(o,0,0,s.width,s.height),e.selfieImageSrc=s.toDataURL("image/png"),n.getTracks().forEach(l=>l.stop()),o.remove(),s.remove()})}catch{console.error("Error al tomar la selfie")}})()}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(m.e),t.Y36(r.F0),t.Y36(r.gz),t.Y36(x.K),t.Y36(p.a),t.Y36(Z.b))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-asistencia"]],decls:14,vars:3,consts:[[1,"ion-padding"],[1,"ion-text-center","ion-padding"],[1,"titulo_principal"],[1,"ion-text-center"],[1,"titulo_secundario"],["alt","Selfie",3,"src",4,"ngIf"],["class","ion-text-start",4,"ngIf"],[1,"div_volver"],[1,"link_volver",3,"click"],["alt","Selfie",3,"src"],[1,"ion-text-start"],[1,"usuario"],[1,"rut_usuario"],[1,"coordenadas"]],template:function(n,o){1&n&&(t.TgZ(0,"ion-content",0)(1,"div",1)(2,"ion-text",2),t._uU(3,"Vault-Tec"),t.qZA(),t.TgZ(4,"div",3)(5,"ion-text",4),t._uU(6,"Clase registrada"),t.qZA()()(),t.TgZ(7,"div",1),t.YNc(8,U,1,1,"img",5),t.qZA(),t.YNc(9,A,9,3,"div",6),t.YNc(10,T,24,6,"div",6),t.TgZ(11,"div",7)(12,"a",8),t.NdJ("click",function(){return o.iraInicio()}),t._uU(13,"Cerrar sesi\xf3n y volver al inicio"),t.qZA()()()),2&n&&(t.xp6(8),t.Q6J("ngIf",o.selfieImageSrc),t.xp6(1),t.Q6J("ngIf",o.loggedInUser),t.xp6(1),t.Q6J("ngIf",o.qrData))},dependencies:[u.O5,c.W2,c.yW],styles:[".titulo_principal[_ngcontent-%COMP%]{font-size:55px}.titulo_secundario[_ngcontent-%COMP%]{font-size:25px;margin-top:3px}.usuario[_ngcontent-%COMP%], .coordenadas[_ngcontent-%COMP%], .rut-usuario[_ngcontent-%COMP%]{font-size:20px;text-align:left}.div_volver[_ngcontent-%COMP%]{position:absolute;margin-top:75px;left:0;padding:10px}.link_volver[_ngcontent-%COMP%]{color:#fff;text-decoration:none}"]})}return i})()}];let I=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[r.Bz.forChild(P),r.Bz]})}return i})(),y=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[u.ez,f.u5,c.Pc,I]})}return i})()}}]);